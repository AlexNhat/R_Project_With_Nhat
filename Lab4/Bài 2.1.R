# Bài 2.1
library(stringr)
library(dplyr)
library(ds4psy)

countries <- ds4psy::countries
countries_df <- data.frame(name = countries)

# T??m t???t c??? các qu???c gia ch???a "ee", "ll" ho???c "oro"
countries_df %>%
  filter(grepl("ee|ll|oro", name))

# Qu???c gia nào có tên ch???a t??? "and" nhýng không ch???a t??? "land"
countries_df %>%
  filter(grepl("and", name) & !grepl("land", name))

# Qu???c gia nào có tên ch???a các ch??? cái "z" ho???c "Z"
countries_df %>%
  filter(grepl("[zZ]", name))

# Qu???c gia nào có tên dài 13 ch??? cái
countries_df %>%
  filter(nchar(name) == 13)

# Tên ný???c nào ch???a các k?? t??? d???u ch???m câu
countries_df %>%
  filter(grepl("[[:punct:]]", name))

# Tên ný???c nào ch???a ðúng 1 ho???c nhi???u hõn 2 kho???ng tr???ng
countries_df %>%
  filter(grepl("^\\S+\\s{1,2}\\S+$", name))

# Qu???c gia nào có tên b???t ð???u b???ng m???t hý???ng chính (t???c là B???c, Ðông, Nam, Tây)
countries_df %>%
  filter(grepl("^(B???c|Ðông|Nam|Tây)", name))

# Qu???c gia nào có tên k???t thúc b???ng "land" so v???i tên ch???a "land" nhýng không k???t thúc b???ng nó
countries_df%>%filter(grepl("land$", name) & !grepl("land$", name, ignore.case = TRUE))


# Qu???c gia nào có tên có m???t ch??? cái ðý???c l???p l???i
countries_df %>%
  filter(grepl("(.)\\1", name))

# Qu???c gia nào có tên ch???a ch??? cái gi???ng nhau nhi???u hõn 3 l???n
countries_df %>%
  filter(grepl("(.)\\1{3,}", name))

# Qu???c gia nào có tên ch???a 3 ho???c nhi???u hõn 3 ch??? cái vi???t hoa
countries_df %>%
  filter(grepl("[[:upper:]].*[[:upper:]].*[[:upper:]].*[[:upper:]]", name))

# Qu???c gia nào có tên ch???a hai ch??? cái vi???t hoa gi???ng nhau
countries_df %>%
  filter(grepl("([[:upper:]]).*\\1", name))
