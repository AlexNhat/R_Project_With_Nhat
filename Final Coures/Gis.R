
# Gis
library(readxl)
data <- read.csv("DataR.txt", header = TRUE, encoding = "UTF-8")

data_geophy <- data$School_Name
options(digits = 16)
data_gis <-read.csv("GisData.csv",header= FALSE, skip=1, encoding = "UTF-8", sep =",",
                    col.names = c("Latitude", "Longitude"))
data_gis$Longitude <- gsub(";", "", data_gis$Longitude)
data_gis$Longitude <- as.numeric(data_gis$Longitude)



library(leaflet)
# T???o b???n ð??? và thêm ???nh n???n 
map <- leaflet(data_gis) %>%
  addTiles() %>%
  setView(lng = 106.705, lat = 10.762, zoom = 12)

# Ðánh d???u các trý???ng ð???i h???c trên b???n ð???
map <- map %>% addMarkers(lng = ~Longitude, lat = ~Latitude)

# Hi???n th??? b???n ð??? map c???a Sài g??n co các ði???m
map


# Ð???m s??? l???n xu???t hi???n qua m???i ði???m
point_counts <- table(data_gis)

# T???o b???n ð??? và thêm ???nh n???n
map <- leaflet(data_gis) %>%
  addTiles() %>%
  setView(lng = 106.705, lat = 10.762, zoom = 12)

# Ðánh d???u các ði???m trên b???n ð??? và thay ð???i màu s???c theo s??? l???n xu???t hi???n
for (i in 1:nrow(data_gis)) {
  lat <- data_gis[i, "Latitude"]
  lon <- data_gis[i, "Longitude"]
  count <- point_counts[toString(lat), toString(lon)]
  color <- ifelse(count > 10, "red", "purple") # Thay ð???i màu s???c d???a trên s??? l???n xu???t hi???n
  
  map <- map %>% addCircleMarkers(lng = lon, lat = lat, color = color)
}

# Hi???n th??? b???n ð???
map





